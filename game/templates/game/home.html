{% load static %}
<!DOCTYPE html>
<html>
<head>
    <title>Home</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Tiny5&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'global.css' %}">
    <link rel="stylesheet" href="{% static 'home.css' %}">
    <style>
        .loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #212529;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
        }
        .loading-screen.hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div class="loading-screen" id="loading-screen">
        <img src="{% static 'images/loading.gif' %}" alt="Loading...">
    </div>
    <div id="content" style="display: none;">
        <img src="{% static 'images/firewall_full_logo.gif' %}" id="logo">
        <ul>
            <li><a href="{% url 'screen_view' first_screen.chapter.num first_screen.num %}" id="start-game-link">Iniciar Jogo</a></li>
            <li><a href="{% url 'continue_progress' %}">Continuar</a></li>
            <li><a href="{% url 'credits' %}">Créditos</a></li>
        </ul>
    </div>
    <script>
        window.addEventListener('load', function() {
            const loadingScreen = document.getElementById('loading-screen');
            const content = document.getElementById('content');
            const startGameLink = document.getElementById('start-game-link');

            // Função para pré-carregar imagens
            function preloadImages(urls) {
                return Promise.all(urls.map(url => {
                    return new Promise((resolve, reject) => {
                        const img = new Image();
                        img.src = url;
                        img.onload = resolve;
                        img.onerror = reject;
                    });
                }));
            }

            // Função para pré-carregar áudios
            function preloadAudios(urls) {
                return Promise.all(urls.map(url => {
                    return new Promise((resolve, reject) => {
                        const audio = new Audio();
                        audio.src = url;
                        audio.oncanplaythrough = resolve;
                        audio.onerror = reject;
                    });
                }));
            }

            // URLs das imagens e áudios a serem pré-carregados
            const imageUrls = [
                
                "{% static 'images/firewall_full_logo.gif' %}",
                // Adicione mais URLs de imagens conforme necessário
                {% for url in media_urls %}
                    "{{ url }}",
                {% endfor %}
                {% for url in static_urls %}
                    "{{ url }}",
                {% endfor %}
            ];

            const audioUrls = [
                "{% static 'audio/success.wav' %}",
                "{% static 'audio/fail.wav' %}",
                // Adicione mais URLs de áudios conforme necessário
                {% for url in audio_urls %}
                    "{{ url }}",
                {% endfor %}
            ];

            // Pré-carregar todos os recursos
            Promise.all([
                preloadImages(imageUrls),
                preloadAudios(audioUrls)
            ]).then(() => {
                loadingScreen.classList.add('hidden');
                content.style.display = 'block';
                startGameLink.addEventListener('click', function(event) {
                    event.preventDefault();
                    // Carregar todos os dados do jogo aqui, se necessário
                    window.location.href = this.href;
                });
            }).catch(error => {
                console.error('Erro ao carregar recursos:', error);
                loadingScreen.textContent = 'Erro ao carregar recursos. Por favor, recarregue a página.';
            });
        });
    </script>
</body>
</html>